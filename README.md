## 🚗 基于 LPRNet 和 STNet 的端到端车牌识别

## 📖 项目背景 (Background)
随着智能交通系统（ITS）的发展，传统的车牌识别方法（涉及图像预处理、定位、分割、识别等分立步骤）在面对倾斜、模糊或光照不均的车牌时，往往因字符分割困难而遇到性能瓶颈。

本项目实现了一种 **无需字符分割** 的端到端（End-to-End）轻量级识别系统。该方法结合了 **空间变换网络（STNet）** 和 **LPRNet**，利用 **CTC Loss** 进行训练，能够在不需要精细校正的情况下，对自然场景下的车牌进行高效、准确的识别。

## ✨ 核心特性 (Key Features)
- **无需分割**：采用端到端策略，避免了传统字符分割的误差积累。
- **鲁棒性强**：引入 STNet 模块，有效处理车牌倾斜和变形问题。
- **轻量高效**：LPRNet 网络设计简洁，适合移动端和嵌入式设备。
- **高准确率**：在 CCPD 数据集上验证集准确率达到 **92.31%**。

## 🛠 软硬件环境 (Environment)
| 组件 | 描述 |
| :--- | :--- |
| **操作系统** | Linux (Kaggle Kernel Environment) |
| **编程语言** | Python 3.x |
| **深度框架** | PyTorch |
| **硬件加速** | NVIDIA GPU (CUDA Support) |
| **依赖库** | OpenCV, Matplotlib, Numpy, Tqdm |

## 📊 数据集与预处理 (Dataset)
- **数据来源**：CCPD (Chinese City Parking Dataset)
- **数据构成**：涵盖多省市车牌，包含复杂背景（雨雪、倾斜、光照不均）。
- **预处理**：
  - 统一尺寸调整为 **94 × 24** (WxH)。
  - 数据增强：亮度/对比度调整、随机仿射变换（旋转/剪切）、高斯模糊。
  - 标签处理：映射为 CTC 计算所需的索引列表。

## 🏗 模型架构 (Architecture)

### 1. 空间变换网络 (STNet)
通过定位网络预测仿射变换参数 $\theta$，对输入图像进行空间校正，使车牌更规范，提升对非受控场景的适应性。

### 2. LPRNet 主干
- 核心组件：**SmallBasicBlock**（利用非对称卷积减少参数量）。
- 特征融合：去除全连接层，使用特征金字塔融合多尺度特征。

### 3. CTC Loss
解决定长序列对齐问题，允许网络输出序列长度与标签长度不一致，引入“空白符”机制实现端到端训练。

#### 技术流程图
<img width="691" height="618" alt="image" src="https://github.com/user-attachments/assets/8025eb9f-41f5-4166-bfa0-1d393475a1fd" />


## 📈 实验结果 (Results)

### 训练指标
- **参数设置**：Epoch=80, Batch Size=64, 初始学习率=0.001 (余弦退火策略)。
- **收敛情况**：Train Loss 快速下降至 0.1 以下；验证集准确率在第 15 个 Epoch 左右达到 80% 以上。
- **最终精度**：验证集最佳准确率稳定在 **92.31%**。

#### 训练 Loss 与 Accuracy 曲线
<img width="681" height="335" alt="image" src="https://github.com/user-attachments/assets/b746353f-c4bb-4197-8eca-e352ea092573" />

-损失收敛情况：
Train Loss (红实线)：初始值较高（>2.0），在前 5-10 个 Epoch 内急剧下降，随后平稳收敛至 0.1 以下。这表明模型具有很强的拟合能力，能够快速学习车牌的特征分布。
Val Loss (红虚线)：验证集损失紧随训练集下降，且未出现明显的反弹（Early Rising），说明模型未出现严重的过拟合现象，Dropout 和数据增强起到了良好的正则化作用。
准确率变化：
Val Accuracy (蓝线)：准确率在第 5 个 Epoch 左右突破 60%，在第 15 个 Epoch 左右达到 80% 以上。
最终在 80 个 Epoch 结束时，验证集准确率稳定在 90% - 95% 区间。取最佳模型准确率92.31%，这证明了 LPRNet 在 CCPD 数据集上具有极高的识别精度。

### 预测效果展示
模型在多种颜色（蓝牌、绿牌）及倾斜角度下均表现良好。

#### 典型案例分析
<img width="692" height="461" alt="image" src="https://github.com/user-attachments/assets/74738302-fc50-48c5-a85d-1794c371a623" />


- **✅ 成功案例**（绿色标注）：即便车牌存在倾斜（如 `皖AD02188`），STNet 也能有效校正并正确识别。
- **❌ 失败案例**（红色标注）：
  - **形近字混淆**：`D` 误识别为 `0`（如 `沪AFD9010` -> `沪AF09010`）。
  - **笔画模糊**：`4` 误识别为 `2`（如 `皖AD02549` -> `皖AD02529`）。

## 🚀 展望 (Future Work)
虽然模型表现优异，但仍有改进空间：
1.  **解码优化**：引入 **Beam Search** 或语言模型约束（如车牌规则）修正 `D/0` 等局部错误。
2.  **难例挖掘**：针对混淆字符（0/D, 8/B, I/1）进行 Hard Example Mining 专项训练。
3.  **模型压缩**：尝试量化（Quantization）或剪枝（Pruning）以适应低功耗嵌入式设备。

---
*本项目基于 PyTorch 实现，欢迎 Star 和 Fork！*
